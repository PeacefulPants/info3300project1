<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="main.js" type="text/javascript"></script>
    <script src="unittest.js" type="text/javascript"></script>
    <style>
        .dataTable {
            border-collapse: collapse;
            width: 100%;
            }

        .dataTable th,
        .dataTable td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;
        }

        .dataTable th {
        background-color: #f2f2f2;
        }

        caption {
            text-align: left;
            padding: 5px;
            border-top: 1px solid #ddd;
            box-shadow: 0 0 5px #ddd;
        }

        .progress-bar {
            height: 20px;
            background-color: green;
            display: inline-block;
        }

        .progress-bar-failed {
            height: 20px;
            background-color: red;
            display: inline-block;
        }

        #failing-tests {
        margin-top: 10px;
        }

        #failing-tests ul {
        list-style: none;
        padding: 0;
        margin: 0;
        }

        #failing-tests li {
        color: red;
        }
    </style>
    </head>
<body>
    <p>
        <h1>Unit Test Status</h1>
        <div id="testStatus"></div>
        <script>
            const totalTests = {
                v: 0,
                set value(v) {
                    this.v = v;
                },
                get value() {
                    return this.v;
                },
                increment() {
                    this.v++;
                }
            };
            var passedTests = {
                v: 0,
                set value(v) {
                    this.v = v;
                },
                get value() {
                    return this.v;
                },
                increment() {
                    this.v++;
                }
            }
            var failedTestNames = [];
            const testSuiteStatusDiv = d3.select("#testStatus");
        </script>
    </p>
    <p>
        <h1>Deep Strict Equality Unit Test 1: Primitives</h1>
        <div id="deepStrictEqualityTestStatus1"></div>
        <script>
            (function() {
                const a = 1;
                const b = 1;

                const expected = true;
                const actual = deepStrictEquality(a, b);

                const testStatusDiv = d3.select("#deepStrictEqualityTestStatus1");
                testPassed(
                    expected, 
                    actual, 
                    testStatusDiv, 
                    totalTests, 
                    passedTests, 
                    failedTestNames, 
                    "Deep Strict Equality Unit Test 1: Primitives",
                    testSuiteStatusDiv);
            })();
        </script>
    </p>
    <p>
        <h1>Deep Strict Equality Unit Test 2: Objects and Primitives</h1>
        <div id="deepStrictEqualityTestStatus2"></div>
        <script>
            (function() {
                const a = 1
                const b = {a: 1, b: 2};

                const expected = false;
                const actual = deepStrictEquality(a, b);

                const testStatusDiv = d3.select("#deepStrictEqualityTestStatus2");
                testPassed(
                    expected, 
                    actual, 
                    testStatusDiv,
                    totalTests,
                    passedTests,
                    failedTestNames,
                    "Deep Strict Equality Unit Test 2: Objects and Primitives",
                    testSuiteStatusDiv);
            })();
        </script>
    </p>
    <p>
        <h1>Deep Strict Equality Unit Test 3: Identical Nested Objects</h1>
        <div id="deepStrictEqualityTestStatus3"></div>
        <script>
            (function() {
                const nestedA = {a: 1, b: 2};
                const a = [nestedA, 2];
                const nestedB = {a: 1, b: 2};
                const b = [nestedB, 2];

                const expected = true;
                const actual = deepStrictEquality(a, b);

                const testStatusDiv = d3.select("#deepStrictEqualityTestStatus3");
                testPassed(
                    expected, 
                    actual, 
                    testStatusDiv,
                    totalTests,
                    passedTests,
                    failedTestNames,
                    "Deep Strict Equality Unit Test 3: Identical Nested Objects",
                    testSuiteStatusDiv);
            })();
        </script>
    </p>
    <p>
        <h1>Deep Strict Equality Unit Test 4: Different Nested Objects</h1>
        <div id="deepStrictEqualityTestStatus4"></div>
        <script>
            (function() {
                const nestedA = {a: 1, c: 3};
                const a = [nestedA, 2];
                const nestedB = {a: 1, b: 2};
                const b = [nestedB, 2];

                const expected = false;
                const actual = deepStrictEquality(a, b);

                const testStatusDiv = d3.select("#deepStrictEqualityTestStatus4");
                testPassed(
                    expected, 
                    actual, 
                    testStatusDiv,
                    totalTests,
                    passedTests,
                    failedTestNames,
                    "Deep Strict Equality Unit Test 4: Different Nested Objects",
                    testSuiteStatusDiv);
            })();
        </script>
    </p>
    <p>
        <h1>Preprocess Unit Test</h1>
        <div id="preprocessRawData"></div>
        <div id="preprocessCleanData"></div>
        <div id="preprocessTestStatus"></div>
        <script>
            (function() {
                    const rawData = [
                    {
                    misc: "some data",
                    Global_Sales: "38.43",
                    Year: "2006", 
                    },
                    {
                        other: "some other data",
                        Global_Sales: "40",
                        Year: "2007"
                    }
                ];

                const expectedData = [
                    {
                        misc: "some data",
                        Global_Sales: 38.43,
                        Year: 2006, 
                    },
                    {
                        other: "some other data",
                        Global_Sales: 40,
                        Year: 2007
                    }
                ];

                const rawDataDiv = d3.select("#preprocessRawData");
                buildTable(rawDataDiv, rawData, "dataTable", "Raw Data: ", true);

                const cleanData = preprocess(rawData);
                const cleanDataDiv = d3.select("#preprocessCleanData");
                buildTable(cleanDataDiv, cleanData, "dataTable", "Clean Data: ", true);

                const testStatusDiv = d3.select("#preprocessTestStatus");
                testPassed(
                    expectedData, 
                    cleanData, 
                    testStatusDiv,
                    totalTests,
                    passedTests,
                    failedTestNames,
                    "Preprocess Unit Test",
                    testSuiteStatusDiv);
            })();
        </script>
    </p>
    <p>
        <h1>Chart Builder Unit Test</h1>
        <div id="chartBuilderTestStatus"></div>
        <script>
            (function(){
                const mockD3 = new MockD3();
                const chartBuilder = new ChartBuilder(mockD3);
                chartBuilder.createSvg(500, 400, "chart1", "svgclass");

                const expectedElements = ["svg"];
                const expectedAttributes = {
                    width: 500,
                    height: 400,
                    class: "svgclass",
                    id: "chart1"
                };
                const expected = {
                    elements: expectedElements,
                    attributes: expectedAttributes
                };

                const actualElements = mockD3.elements;
                const actualAttributes = mockD3.attributes;
                const actual = {
                    elements: actualElements,
                    attributes: actualAttributes
                };

                const chartBuilderTestStatus = d3.select("#chartBuilderTestStatus");
                testPassed(
                    expected, 
                    actual, 
                    chartBuilderTestStatus,
                    totalTests,
                    passedTests,
                    failedTestNames,
                    "Chart Builder Unit Test",
                    testSuiteStatusDiv);
            })();
        </script>
    </p>    
</body>
</html>
